---
title: "EDA"
author: "Elinor chu"
date: "12/6/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(lubridate)
library(tidyverse)
library(ggplot2)
library(readr)
library(readxl)
library(usdata)
library(tm)
library(stringr)


library(kableExtra)
```

```{r}
theft_train=read_csv("../data/clean/theft_train.csv")
```

```{r}
theft_train %>% select(-fips, -state, -county) %>%
ggplot(aes(x = theftrate)) +
  geom_histogram()+
  theme_bw()+
  scale_y_log10()
```

```{r}
theft_train %>% select(-fips, -state, -county) %>%
ggplot(aes(y=theftrate)) +
  geom_boxplot()+
  theme_bw()
```

```{r}
theft_train %>% select(state,county,theftrate) %>% arrange(desc(theftrate)) %>% head(10) %>%
  kable(format = "latex", row.names = NA, 
        booktabs = TRUE,
        digits = 3,
        col.names = c("State", "County","Theft Rate"),
        caption = "This a table showing the top 10 counties with the highest theft rate.") %>%
  kable_styling(position = "center") %>%
  kable_styling(latex_options = "HOLD_position")
```

#EDA for important features

```{r}
# plot theftrate against poor_fair_health
p1 = theft_train %>% select(-fips, -state, -county) %>% 
  ggplot(aes(x = poor_fair_health, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "Poor/Fair Health", 
       y = "Theft Rate",
       title = "Poor/Fair Health") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
theft_train %>% arrange(desc(poor_fair_health))%>%head(5)
```



```{r}
# plot theftrate against housing_density
p2 = theft_train %>% select(-fips, -state, -county)%>%
  ggplot(aes(x = housing_density, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "Housing Density", 
       y = "Theft Rate",
       title = "Housing Density") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```


```{r}
theft_train %>% arrange(desc(housing_density))%>%head(5)
```


```{r}
# plot theftrate against pop_density
p3 = theft_train %>% select(-fips, -state, -county) %>%
  ggplot(aes(x = pop_density, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "Population Density", 
       y = "Theft Rate",
       title = "Population Density") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
theft_train %>% arrange(desc(pop_density))%>%head(5)
```


```{r}
# plot theftrate against pertrump
p4 = theft_train %>% select(-fips, -state, -county)%>%
  ggplot(aes(x = pertrump, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "Pertrump", 
       y = "Theft Rate",
       title = "Pertrump") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
theft_train %>% arrange(desc(pertrump))%>%head(5)
```


```{r}
# plot theftrate against PctEmpFIRE
p5 = theft_train %>% select(-fips, -state, -county)%>%
  ggplot(aes(x = PctEmpFIRE, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "PctEmpFIRE", 
       y = "Theft Rate",
       title = "PctEmpFIRE") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
theft_train %>% arrange(desc(PctEmpFIRE))%>%select(state, county, PctEmpFIRE, theftrate)%>%head(5)
```


```{r}
# plot theftrate against saversperpop
p6 = theft_train %>% select(-fips, -state, -county)%>%
  ggplot(aes(x = saversperpop, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "saversperpop", 
       y = "Theft Rate",
       title = "saversperpop") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```


```{r}
theft_train %>% arrange(desc(saversperpop))%>%select(state, county, saversperpop, theftrate)%>%head(5)
```


```{r}
# plot theftrate against unemp_bens_possible
p7 = theft_train %>% select(-fips, -state, -county)%>%
  ggplot(aes(x = unemp_bens_possible, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "unemp_bens_possible", 
       y = "Theft Rate",
       title = "unemp_bens_possible") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```



```{r}
# plot theftrate against lessthan_hs
p8= theft_train %>% select(-fips, -state, -county)%>%
  ggplot(aes(x = lessthan_hs, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "lessthan_hs", 
       y = "Theft Rate",
       title = "lessthan_hs") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
theft_train %>% arrange(desc(lessthan_hs))%>%select(state, county, lessthan_hs, theftrate)%>%head(5)
```

```{r}
# plot theftrate against PctEmpConstruction
p9= theft_train %>% select(-fips, -state, -county)%>%
  ggplot(aes(x = PctEmpConstruction, y = theftrate)) +
  geom_point() + 
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE) +
  labs(x = "PctEmpConstruction", 
       y = "Theft Rate",
       title = "PctEmpConstruction") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}
theft_train %>% arrange(desc(PctEmpConstruction))%>%select(state, county, PctEmpConstruction, theftrate)%>%head(5)
```

